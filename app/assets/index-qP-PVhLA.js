import{r as l,t as Se,c as ke,j as e,V as re,R as ae,A as oe,C as ne,X as ie,T as le,D as ce,a as Ae,P as Ee,b as Ie,d as Le,e as de,f as Oe,m as C,u as G,g as Q,h as me,i as Re,U as Fe,k as M,E as I,l as ze,n as De,o as Ve,p as $e,q as Me,s as ue,v as xe,w as Ye,x as pe,y as he,z as U,B as J,F as Ue,G as _e,H as Be,L as qe,I as Qe,Q as He,J as Ge,K as We,M as Ke,N as z,O as Z}from"./vendor-De3giDWX.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function r(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(n){if(n.ep)return;n.ep=!0;const o=r(n);fetch(n.href,o)}})();const Xe=1,Je=1e6;let _=0;function Ze(){return _=(_+1)%Number.MAX_SAFE_INTEGER,_.toString()}const B=new Map,ee=t=>{if(B.has(t))return;const s=setTimeout(()=>{B.delete(t),E({type:"REMOVE_TOAST",toastId:t})},Je);B.set(t,s)},et=(t,s)=>{switch(s.type){case"ADD_TOAST":return{...t,toasts:[s.toast,...t.toasts].slice(0,Xe)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(r=>r.id===s.toast.id?{...r,...s.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=s;return r?ee(r):t.toasts.forEach(a=>{ee(a.id)}),{...t,toasts:t.toasts.map(a=>a.id===r||r===void 0?{...a,open:!1}:a)}}case"REMOVE_TOAST":return s.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(r=>r.id!==s.toastId)}}},D=[];let V={toasts:[]};function E(t){V=et(V,t),D.forEach(s=>{s(V)})}function tt({...t}){const s=Ze(),r=n=>E({type:"UPDATE_TOAST",toast:{...n,id:s}}),a=()=>E({type:"DISMISS_TOAST",toastId:s});return E({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:n=>{n||a()}}}),{id:s,dismiss:a,update:r}}function L(){const[t,s]=l.useState(V);return l.useEffect(()=>(D.push(s),()=>{const r=D.indexOf(s);r>-1&&D.splice(r,1)}),[t]),{...t,toast:tt,dismiss:r=>E({type:"DISMISS_TOAST",toastId:r})}}function T(...t){return Se(ke(t))}const st=Ee,fe=l.forwardRef(({className:t,...s},r)=>e.jsx(re,{ref:r,className:T("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...s}));fe.displayName=re.displayName;const rt=Ae("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),ge=l.forwardRef(({className:t,variant:s,...r},a)=>e.jsx(ae,{ref:a,className:T(rt({variant:s}),t),...r}));ge.displayName=ae.displayName;const at=l.forwardRef(({className:t,...s},r)=>e.jsx(oe,{ref:r,className:T("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...s}));at.displayName=oe.displayName;const je=l.forwardRef(({className:t,...s},r)=>e.jsx(ne,{ref:r,className:T("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...s,children:e.jsx(ie,{className:"h-4 w-4"})}));je.displayName=ne.displayName;const be=l.forwardRef(({className:t,...s},r)=>e.jsx(le,{ref:r,className:T("text-sm font-semibold",t),...s}));be.displayName=le.displayName;const ye=l.forwardRef(({className:t,...s},r)=>e.jsx(ce,{ref:r,className:T("text-sm opacity-90",t),...s}));ye.displayName=ce.displayName;function ot(){const{toasts:t}=L();return e.jsxs(st,{children:[t.map(function({id:s,title:r,description:a,action:n,...o}){return e.jsxs(ge,{...o,children:[e.jsxs("div",{className:"grid gap-1",children:[r&&e.jsx(be,{children:r}),a&&e.jsx(ye,{children:a})]}),n,e.jsx(je,{})]},s)}),e.jsx(fe,{})]})}const nt=({...t})=>{const{theme:s="system"}=Ie();return e.jsx(Le,{theme:s,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t})},it=Oe,lt=l.forwardRef(({className:t,sideOffset:s=4,...r},a)=>e.jsx(de,{ref:a,sideOffset:s,className:T("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r}));lt.displayName=de.displayName;const m=({children:t,duration:s=.5,delay:r=0,className:a=""})=>e.jsx(C.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:s,delay:r,ease:"easeInOut"},className:a,children:t}),ct=({children:t,scale:s=1.03,className:r=""})=>e.jsx(C.div,{whileHover:{scale:s},whileTap:{scale:.98},transition:{duration:.2},className:r,children:t}),dt=({size:t=48,className:s=""})=>e.jsxs(C.svg,{width:t,height:t,viewBox:"0 0 50 50",className:s,children:[e.jsx(C.circle,{cx:"25",cy:"25",r:"20",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",initial:{pathLength:0,opacity:0},animate:{pathLength:1,opacity:1},transition:{duration:.5,ease:"easeInOut"}}),e.jsx(C.path,{d:"M15 25 L22 32 L35 18",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",initial:{pathLength:0,opacity:0},animate:{pathLength:1,opacity:1},transition:{duration:.5,delay:.3,ease:"easeInOut"}})]}),mt=(t="demo",s,r=window.location.origin)=>{const a=`${r}/app/pay/${t}`;return s?`${a}?name=${encodeURIComponent(s)}`:a},ut=(t,s=window.location.origin)=>{const r=ve();return xt(r,t,s)},xt=(t="demo",s,r=window.location.origin)=>{const a=`${r}/app/collect/${t}`;return s?`${a}?amount=${s}`:a},ve=()=>Math.random().toString(36).substring(2,10),pt=(t,s)=>{const r=t.reduce((a,n)=>a+(n.amount||0),0);return parseFloat((s-r).toFixed(2))},ht=(t,s)=>{if(t.length===0)return[];const r=s/t.length;return t.map(a=>({...a,amount:parseFloat(r.toFixed(2))}))},ft=()=>{const[t,s]=l.useState(""),[r,a]=l.useState(!1),[n,o]=l.useState(""),c=G(),{toast:x}=L(),p=async f=>{f.preventDefault();const v=parseFloat(t);if(!t||isNaN(v)||v<=0){x({title:"Invalid amount",description:"Please enter a valid payment amount",variant:"destructive"});return}try{a(!0);const g=ut(v);o(g),setTimeout(()=>{a(!1)},500)}catch(g){console.error("Error creating test link:",g),x({title:"Error",description:"Failed to create test link. Please try again.",variant:"destructive"}),a(!1)}},y=()=>{if(n){const f=new URL(n),v=f.pathname+f.search;c(v)}},P=()=>{n&&(navigator.clipboard.writeText(n),x({title:"Link copied",description:"Test collector link copied to clipboard"}))};return e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx("header",{className:"py-6 px-4 border-b border-border",children:e.jsx("div",{className:"container max-w-6xl",children:e.jsx("img",{src:"OnePool.png",alt:"OnePool Logo",className:"logo-image primary-logo"})})}),e.jsx("main",{className:"flex-1 flex items-center justify-center px-4 py-12",children:e.jsxs(m,{className:"w-full max-w-lg",children:[e.jsx("div",{className:"text-center mb-8",children:e.jsxs(m,{children:[e.jsx("h1",{className:"text-4xl font-bold mb-3",children:"B2B Checkout Solution"}),e.jsx("p",{className:"text-xl text-muted-foreground",children:"Create a test collector link with an amount"})]})}),e.jsx(m,{delay:.1,children:e.jsxs("div",{className:"glass-card p-8 mb-6",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-6",children:"Test Collector Link"}),e.jsxs("form",{onSubmit:p,children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium mb-2",children:"Total Amount"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"amount",type:"number",min:"0.01",step:"0.01",value:t,onChange:f=>s(f.target.value),className:"input-field pl-12 pr-12 text-lg w-full",placeholder:"0.00",required:!0}),e.jsx("div",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-muted-foreground",children:"€"})]})]}),e.jsx("button",{type:"submit",className:"btn-primary w-full text-base",disabled:r,children:r?e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-t-white/0 border-white rounded-full animate-spin mr-2"}),"Creating..."]}):"Create Collector Link"})]}),n&&e.jsxs("div",{className:"mt-6 p-4 border border-border rounded-lg bg-secondary/10",children:[e.jsx("p",{className:"font-medium mb-2",children:"Test Link Generated:"}),e.jsxs("div",{className:"flex items-center justify-between gap-2 mb-3",children:[e.jsx("div",{className:"truncate text-sm text-muted-foreground",children:n}),e.jsx("button",{onClick:P,className:"p-2 bg-primary/10 text-primary rounded-full hover:bg-primary/20 transition-colors",children:e.jsx(Q,{size:16})})]}),e.jsxs("button",{onClick:y,className:"btn-primary w-full flex items-center justify-center",children:["Open Collector Page",e.jsx(me,{size:16,className:"ml-2"})]})]})]})}),e.jsx(m,{delay:.3,className:"text-center",children:e.jsx("p",{className:"text-muted-foreground",children:"This page is for testing purposes only. In production, collector links will be created by merchants."})})]})}),e.jsx("footer",{className:"py-6 px-4 border-t border-border",children:e.jsxs("div",{className:"container max-w-6xl text-center text-sm text-muted-foreground",children:["OnePool © ",new Date().getFullYear()," — All rights reserved"]})})]})},$=({children:t,isVisible:s=!0,direction:r="up",duration:a=.5,delay:n=0,className:o=""})=>e.jsx(Re,{children:s&&e.jsx(C.div,{initial:{opacity:0,...te(r)},animate:{opacity:1,...gt(r),transition:{duration:a,delay:n,ease:"easeOut"}},exit:{opacity:0,...te(r),transition:{duration:a*.8,ease:"easeIn"}},className:o,children:t})});function te(t){switch(t){case"up":return{y:20};case"down":return{y:-20};case"left":return{x:20};case"right":return{x:-20}}}function gt(t){switch(t){case"up":return{y:0};case"down":return{y:0};case"left":return{x:0};case"right":return{x:0}}}const H=({contributor:t,totalAmount:s,onRemove:r,onEdit:a,onNameChange:n,isCollector:o=!0,index:c=0})=>{const x=t.amount/s*100;return e.jsx(m,{delay:c*.1,children:e.jsx(ct,{scale:1.02,children:e.jsxs("div",{className:"glass-card p-4 mb-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-full bg-primary/10 flex items-center justify-center text-primary",children:e.jsx(Fe,{size:18})}),o&&t.isEditing?e.jsx("input",{className:"input-field py-1 px-2 text-sm w-[120px]",value:t.name||"",onChange:p=>n==null?void 0:n(t.id,p.target.value),placeholder:"Name",autoFocus:!0}):e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:t.name||"Unnamed"}),e.jsxs("div",{className:"flex items-center mt-1 text-xs text-muted-foreground",children:[t.hasVerified&&e.jsxs("div",{className:"flex items-center text-emerald-600",children:[e.jsx(M,{size:12,className:"mr-1"}),e.jsx("span",{children:"Verified"})]}),t.hasPaid&&e.jsxs("div",{className:"flex items-center text-emerald-600 ml-2",children:[e.jsx(M,{size:12,className:"mr-1"}),e.jsx("span",{children:"Paid"})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&t.isEditing?e.jsx("input",{type:"number",min:"0",step:"0.01",className:"input-field py-1 px-2 text-sm w-[100px]",value:t.amount,onChange:p=>a==null?void 0:a(t.id,parseFloat(p.target.value)||0)}):e.jsxs("div",{className:"flex items-center px-3 py-1.5 bg-primary/5 rounded-lg",children:[e.jsx("span",{className:"font-medium",children:t.amount.toFixed(2)}),e.jsx(I,{size:14,className:"ml-1 text-muted-foreground"})]}),o&&r&&e.jsx("button",{onClick:()=>r(t.id),className:"w-8 h-8 flex items-center justify-center rounded-full text-destructive hover:bg-destructive/10 transition-colors",children:e.jsx(ie,{size:16})})]})]}),o&&e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"relative h-2 bg-secondary rounded-full overflow-hidden",children:e.jsx(C.div,{initial:{width:0},animate:{width:`${x}%`},transition:{duration:.5,ease:"easeOut"},className:"absolute top-0 left-0 h-full bg-primary"})}),e.jsxs("div",{className:"flex justify-between mt-1 text-xs text-muted-foreground",children:[e.jsxs("span",{children:[x.toFixed(1),"%"]}),e.jsxs("span",{children:["of $",s.toFixed(2)]})]})]})]})})})},jt={apiKey:"AIzaSyA4GUJv-M4W5ZaY-5-6yGY6um_X1EBWEQg",authDomain:"onepool-800e2.firebaseapp.com",projectId:"onepool-800e2",storageBucket:"onepool-800e2.appspot.com",messagingSenderId:"370160885219",appId:"1:370160885219:web:7a5c223281ab96c047d4d6",measurementId:"G-QSTDV4QVZM"},bt=ze(jt),W=De(bt),yt=async(t,s="Payment",r=[])=>{try{const a=Ve(W,"pools"),n={id:"",createdAt:$e.now(),totalAmount:t,subscriptionName:s,contributors:r},o=await Me(a,n),c=o.id;return await ue(o,{...n,id:c},{merge:!0}),c}catch(a){throw console.error("Error creating pool:",a),a}},K=async t=>{try{const s=xe(W,"pools",t),r=await Ye(s);return r.exists()?r.data():(console.log("No such pool exists!"),null)}catch(s){throw console.error("Error getting pool:",s),s}},Ne=async(t,s)=>{try{const r=xe(W,"pools",t);await ue(r,{contributors:s},{merge:!0})}catch(r){throw console.error("Error updating pool contributors:",r),r}},vt=async(t,s,r)=>{try{const a=await K(t);if(!a)throw new Error("Pool not found");const n=a.contributors.map(o=>o.id===s?{...o,...r}:o);await Ne(t,n)}catch(a){throw console.error("Error updating contributor status:",a),a}},Nt=()=>{const{poolId:t="demo"}=pe(),[s]=he(),r=G(),[a,n]=l.useState(0),[o,c]=l.useState([]),[x,p]=l.useState(0),[y,P]=l.useState(null),[f,v]=l.useState("Payment"),[g,O]=l.useState(!0),[b,S]=l.useState(!1),{toast:j}=L();l.useEffect(()=>{(async()=>{try{const d=s.get("amount"),u=d?parseFloat(d):0;if(!d||isNaN(u)||u<=0){j({title:"Invalid amount",description:"Please provide a valid amount in the URL",variant:"destructive"}),r("/");return}if(t==="demo")n(u),p(u),c([]),S(!0);else{const k=await K(t);if(!k)n(u),p(u),c([]),S(!0);else{n(k.totalAmount),c(k.contributors||[]),v(k.subscriptionName||"Payment");const Ce=k.contributors.reduce((Te,Pe)=>Te+Pe.amount,0);p(parseFloat((k.totalAmount-Ce).toFixed(2))),S(!1)}}}catch(d){console.error("Error fetching pool:",d),j({title:"Error",description:"Failed to load payment pool data",variant:"destructive"})}finally{O(!1)}})()},[t,s,r,j]),l.useEffect(()=>{p(pt(o,a))},[o,a]);const R=()=>{const i={id:ve(),name:`Person ${o.length+1}`,amount:0,isEditing:!0};c([...o,i]),P(i.id),setTimeout(()=>{const d=document.getElementById(`contributor-${i.id}`);d==null||d.scrollIntoView({behavior:"smooth",block:"end"})},100)},F=i=>{c(o.filter(d=>d.id!==i))},N=(i,d)=>{c(o.map(u=>u.id===i?{...u,amount:d}:u))},h=(i,d)=>{c(o.map(u=>u.id===i?{...u,name:d}:u))},w=()=>{if(o.length===0){j({title:"No contributors",description:"Add contributors first to distribute the amount",variant:"destructive"});return}c(ht(o,a))},A=i=>{c(o.map(d=>d.id===i?{...d,isEditing:!d.isEditing}:d)),P(y===i?null:i)},Y=async()=>{if(o.length===0){j({title:"No contributors",description:"Add contributors first to save",variant:"destructive"});return}if(o.some(i=>!i.name||i.name.trim()==="")){j({title:"Missing names",description:"Please provide names for all contributors",variant:"destructive"});return}try{let i=t;b?(i=await yt(a,f,o),r(`/collect/${i}?amount=${a}`,{replace:!0}),S(!1)):await Ne(t,o),j({title:"Contributors saved",description:`Saved ${o.length} contributors to the pool`})}catch(i){console.error("Error saving contributors:",i),j({title:"Error",description:"Failed to save contributors",variant:"destructive"})}},we=i=>mt(t,i.name),X=i=>{navigator.clipboard.writeText(we(i)),j({title:"Link copied",description:`Payment link for ${i.name} copied to clipboard`})};return g?e.jsx("div",{className:"h-screen flex items-center justify-center",children:e.jsx("div",{className:"w-12 h-12 border-4 border-primary border-t-transparent rounded-full animate-spin"})}):a<=0?null:e.jsx($,{children:e.jsx("div",{className:"max-w-2xl mx-auto px-4 py-8",children:e.jsxs(m,{children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"chip mb-2 bg-primary/10 text-primary",children:"PAYMENT COLLECTION"}),e.jsxs("h1",{className:"text-3xl font-semibold mb-2",children:["Collect ",f]}),e.jsx("p",{className:"text-muted-foreground",children:"Add contributors and distribute the payment amount"})]}),e.jsxs("div",{className:"glass-card p-5 mb-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2.5 rounded-full bg-primary/10 text-primary mr-3",children:e.jsx(I,{size:18})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Amount"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-2xl font-semibold",children:a.toFixed(2)}),e.jsx(I,{size:16,className:"ml-1 text-muted-foreground"})]})]})]})}),e.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-border",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"p-2.5 rounded-full bg-primary/10 text-primary mr-3 mt-1",children:e.jsx(U,{size:18})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Contributors"}),e.jsx("p",{className:"text-xl font-medium",children:o.length})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Remaining"}),e.jsxs("div",{className:`text-xl font-medium ${x!==0?"text-amber-500":"text-emerald-500"}`,children:[x.toFixed(2)," €"]})]})]})]}),e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsx("h2",{className:"text-xl font-medium",children:"Contributors"})}),e.jsxs("div",{className:"flex gap-2 mb-6",children:[e.jsxs("button",{onClick:w,className:"px-4 py-2 border border-input rounded-lg text-sm font-medium hover:bg-secondary transition-colors flex items-center",disabled:o.length===0,children:[e.jsx(U,{size:16,className:"mr-2"}),"Split Evenly"]}),e.jsxs("button",{onClick:R,className:"btn-primary flex items-center",children:[e.jsx(J,{size:16,className:"mr-2"}),"Add Person"]})]}),o.length===0?e.jsx(m,{children:e.jsxs("div",{className:"glass-card p-6 text-center mb-6",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center text-primary mx-auto mb-3",children:e.jsx(U,{size:24})}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No Contributors Yet"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Add people to split the payment amount"}),e.jsxs("button",{onClick:R,className:"btn-primary inline-flex items-center",children:[e.jsx(J,{size:16,className:"mr-2"}),"Add Person"]})]})}):e.jsxs(e.Fragment,{children:[e.jsx(m,{delay:.1,className:"mb-6",children:o.map((i,d)=>e.jsxs("div",{id:`contributor-${i.id}`,className:"relative mb-4 group",onClick:()=>A(i.id),children:[e.jsx(H,{contributor:i,totalAmount:a,onRemove:F,onEdit:N,onNameChange:h,index:d}),!i.isEditing&&e.jsx("div",{className:"absolute right-3 top-4 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("button",{onClick:u=>{u.stopPropagation(),X(i)},className:"p-2 rounded-full bg-primary/5 text-primary hover:bg-primary/10 transition-colors",title:`Copy payment link for ${i.name}`,children:e.jsx(Q,{size:14})})})]},i.id))}),o.length>0&&x===0&&e.jsx("div",{className:"flex justify-end mb-6",children:e.jsx("button",{onClick:Y,className:"btn-primary",children:b?"Create Pool & Save":"Save Contributors"})}),o.some(i=>i.name&&i.amount>0)&&e.jsx(m,{children:e.jsxs("div",{className:"glass-card p-5 mb-6",children:[e.jsx("h3",{className:"font-medium mb-3",children:"Contributor Links"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Share these links with individual contributors to collect their payments"}),e.jsx("div",{className:"space-y-3",children:o.filter(i=>i.name&&i.amount>0).map(i=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-secondary/30 rounded-lg",children:[e.jsx("div",{className:"font-medium truncate mr-2",children:i.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"text-xs text-muted-foreground",children:[i.amount.toFixed(2)," €"]}),e.jsx("button",{onClick:()=>X(i),className:"p-1.5 rounded-full bg-primary/10 text-primary hover:bg-primary/20 transition-colors",title:`Copy payment link for ${i.name}`,children:e.jsx(Q,{size:14})})]})]},`link-${i.id}`))})]})})]})]})})})},wt=({onSuccess:t,onCancel:s})=>{const[r,a]=l.useState("initial"),{toast:n}=L(),o=()=>{a("processing"),setTimeout(()=>{a("success"),n({title:"Verification successful",description:"Your payment method has been verified"}),setTimeout(()=>{t()},1500)},2e3)};return e.jsxs("div",{className:"w-full max-w-md mx-auto",children:[r==="initial"&&e.jsx($,{children:e.jsxs("div",{className:"glass-card p-6",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center text-primary mx-auto mb-4",children:e.jsx(Ue,{size:24})}),e.jsx("h3",{className:"text-xl font-medium text-center mb-2",children:"Verification Payment"}),e.jsx("p",{className:"text-muted-foreground text-center mb-6",children:"We'll make a temporary 0€ verification charge to confirm your payment method"}),e.jsx("div",{className:"flex items-center justify-center mb-6",children:e.jsxs("div",{className:"px-5 py-3 bg-primary/5 rounded-lg flex items-center justify-center",children:[e.jsx("span",{className:"font-medium text-2xl",children:"0.00"}),e.jsx(I,{size:20,className:"ml-1 text-muted-foreground"})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("button",{onClick:s,className:"px-4 py-2.5 border border-input rounded-lg text-sm font-medium hover:bg-secondary transition-colors",children:"Cancel"}),e.jsx("button",{onClick:o,className:"btn-primary",children:"Verify"})]})]})}),r==="processing"&&e.jsx($,{children:e.jsxs("div",{className:"glass-card p-6 flex flex-col items-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full border-4 border-t-primary border-r-primary/30 border-b-primary/10 border-l-primary/30 animate-spin mb-6"}),e.jsx("h3",{className:"text-xl font-medium mb-2",children:"Processing"}),e.jsx("p",{className:"text-muted-foreground text-center",children:"Verifying your payment method..."})]})}),r==="success"&&e.jsx($,{children:e.jsxs("div",{className:"glass-card p-6 flex flex-col items-center",children:[e.jsx("div",{className:"text-emerald-500 mb-4",children:e.jsx(dt,{size:64})}),e.jsx("h3",{className:"text-xl font-medium mb-2",children:"Verification Complete!"}),e.jsx("p",{className:"text-muted-foreground text-center",children:"Your payment method has been successfully verified"})]})})]})},Ct=()=>{const{poolId:t="demo"}=pe(),[s]=he(),r=G(),[a,n]=l.useState("details"),[o,c]=l.useState(""),[x,p]=l.useState(0),[y,P]=l.useState(null),[f,v]=l.useState(!0),[g,O]=l.useState(""),{toast:b}=L();l.useEffect(()=>{(async()=>{try{if(!t){r("/");return}const h=s.get("name");h&&c(decodeURIComponent(h));const w=await K(t);if(!w){b({title:"Pool not found",description:"The requested payment pool doesn't exist",variant:"destructive"}),r("/");return}if(P(w),h){const A=w.contributors.find(Y=>Y.name===decodeURIComponent(h));A?(p(A.amount),O(A.id)):b({title:"Contributor not found",description:"Your name was not found in this payment pool",variant:"destructive"})}}catch(h){console.error("Error fetching pool data:",h),b({title:"Error",description:"Failed to load payment details",variant:"destructive"})}finally{v(!1)}})()},[t,s,r,b]);const S=N=>{if(N.preventDefault(),!o){b({title:"Name required",description:"Please enter your name to continue",variant:"destructive"});return}if(!g&&y){const h=y.contributors.find(w=>w.name===o);if(h)p(h.amount),O(h.id);else{b({title:"Contributor not found",description:"Your name was not found in this payment pool",variant:"destructive"});return}}n("verification")},j=async()=>{try{t!=="demo"&&g&&await vt(t,g,{hasVerified:!0,hasPaid:!0}),n("success"),b({title:"Verification successful",description:"Your payment method has been verified"})}catch(N){console.error("Error updating contributor status:",N),n("success")}},R=()=>{n("details")};if(f)return e.jsx("div",{className:"h-screen flex items-center justify-center",children:e.jsx("div",{className:"w-12 h-12 border-4 border-primary border-t-transparent rounded-full animate-spin"})});if(!y)return null;const F={id:g||"temp-id",name:o||"You",amount:x,hasVerified:a==="success",hasPaid:a==="success"};return e.jsxs("div",{className:"max-w-md mx-auto px-4 py-8",children:[a==="details"&&e.jsxs(m,{children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"chip mb-2 bg-primary/10 text-primary",children:"PAYMENT REQUEST"}),e.jsx("h1",{className:"text-3xl font-semibold mb-2",children:"Your Payment"}),e.jsx("p",{className:"text-muted-foreground",children:"Complete the form below to make your payment"})]}),e.jsx(m,{children:e.jsx("form",{onSubmit:S,className:"mb-6",children:e.jsxs("div",{className:"glass-card p-5",children:[e.jsx("h2",{className:"text-lg font-medium mb-4",children:"Who Are You?"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium mb-1",children:"Your Name"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",children:e.jsx(_e,{size:18})}),e.jsx("input",{id:"name",type:"text",value:o,onChange:N=>c(N.target.value),className:"input-field pl-10 w-full",placeholder:"Enter your name",required:!0,disabled:!!s.get("name")})]}),s.get("name")&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Your name is provided in the payment link"})]}),e.jsxs("button",{type:"submit",className:"btn-primary w-full flex items-center justify-center",children:["Continue to Payment",e.jsx(me,{size:16,className:"ml-2"})]})]})})}),g&&e.jsx(m,{delay:.2,children:e.jsx(H,{contributor:F,totalAmount:y.totalAmount,isCollector:!1})})]}),a==="verification"&&e.jsxs(m,{children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"chip mb-2 bg-primary/10 text-primary",children:"PAYMENT VERIFICATION"}),e.jsx("h1",{className:"text-3xl font-semibold mb-2",children:"Verify Payment"}),e.jsx("p",{className:"text-muted-foreground",children:"Complete a 0€ verification to confirm your payment method"})]}),e.jsx(wt,{onSuccess:j,onCancel:R})]}),a==="success"&&e.jsxs(m,{children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"text-emerald-500 mb-4 inline-block",children:e.jsx(M,{className:"w-20 h-20 p-4 rounded-full bg-emerald-100"})}),e.jsx("h1",{className:"text-3xl font-semibold mb-2",children:"Payment Complete!"}),e.jsxs("p",{className:"text-muted-foreground",children:["Thank you, ",o,". Your payment has been successfully processed."]})]}),e.jsx(m,{children:e.jsx("div",{className:"glass-card p-5 mb-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2.5 rounded-full bg-emerald-100 text-emerald-600 mr-3",children:e.jsx(M,{size:18})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Paid Amount"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-2xl font-semibold",children:x.toFixed(2)}),e.jsx(I,{size:18,className:"ml-1 text-muted-foreground"})]})]})]}),e.jsx("div",{className:"chip bg-emerald-100 text-emerald-700",children:"Complete"})]})})}),e.jsx(m,{delay:.2,children:e.jsx(H,{contributor:F,totalAmount:y.totalAmount,isCollector:!1})})]})]})},Tt=()=>{const t=Be();return l.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",t.pathname)},[t.pathname]),e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 bg-background",children:e.jsxs(m,{className:"text-center",children:[e.jsx("h1",{className:"text-9xl font-bold text-primary/20",children:"404"}),e.jsx("h2",{className:"text-2xl font-bold mt-6 mb-3",children:"Page Not Found"}),e.jsx("p",{className:"text-muted-foreground mb-8 max-w-md mx-auto",children:"The page you're looking for doesn't exist or has been removed."}),e.jsxs(qe,{to:"/",className:"btn-primary inline-flex items-center px-4 py-2 rounded bg-primary text-primary-foreground hover:bg-primary/90",children:[e.jsx(Qe,{size:18,className:"mr-2"}),"Return Home"]})]})})},Pt=new He,se=()=>e.jsx(Ge,{client:Pt,children:e.jsxs(it,{children:[e.jsx(ot,{}),e.jsx(nt,{}),e.jsx(We,{basename:"/app",children:e.jsxs(Ke,{children:[e.jsx(z,{path:"/",element:e.jsx(ft,{})}),e.jsx(z,{path:"/collect/:poolId",element:e.jsx(Nt,{})}),e.jsx(z,{path:"/pay/:poolId",element:e.jsx(Ct,{})}),e.jsx(z,{path:"*",element:e.jsx(Tt,{})})]})})]})}),q=document.getElementById("root");if(q){const t=Z(q);try{t.render(e.jsx(se,{}))}catch(s){console.error("Error rendering the app:",s),q.innerHTML='<div style="color: red; padding: 20px;">An error occurred while loading the application. Please refresh the page or check the console for more details.</div>'}}else{console.error("Failed to find the root element");const t=document.createElement("div");t.id="root",document.body.appendChild(t);const s=Z(t);try{s.render(e.jsx(se,{}))}catch(r){console.error("Error rendering the app:",r),t.innerHTML='<div style="color: red; padding: 20px;">An error occurred while loading the application. Please refresh the page or check the console for more details.</div>'}}
//# sourceMappingURL=index-qP-PVhLA.js.map
